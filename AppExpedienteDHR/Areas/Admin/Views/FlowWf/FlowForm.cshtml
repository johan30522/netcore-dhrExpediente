@using AppExpedienteDHR.Core.ViewModels.Workflow
@model FlowFormViewModel


@{
    ViewData["Title"] = Model.Flow.Id == 0 ? "Crear Flujo de Trabajo" : "Flujo de Trabajo";
    var tableGroupId = "tblGroups";
    var flowId = Model.Flow.Id;
}

<br />
<br />

<h3 class="text-center">@ViewData["Title"]</h3>

<hr />

<div class="container-fluid custom-container-lg-xl">
    <div class="row ">
        <div class="col-12 border border-light rounded p-2">
            <form method="post" asp-action="Save">
                <div asp-validation-summary="ModelOnly" class="text-danger text-center"></div>
                <input type="hidden" asp-for="Flow.Id" />
                <div class="col-10 offset-1 mt-4">
                    <div class="form-group row mt-3">
                        <div class="col-8">
                            <partial name="_ViewCreateReturn" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label asp-for="Flow.Order" class="control-label"></label>
                        <input asp-for="Flow.Order" class="form-control" />
                        <div class="offset-3">
                            <span asp-validation-for="Flow.Order" class="text-danger text-center"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label asp-for="Flow.Name" class="control-label"></label>
                        <input asp-for="Flow.Name" class="form-control" />
                        <div class="offset-3">
                            <span asp-validation-for="Flow.Name" class="text-danger text-center"></span>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    @if (Model.Flow.Id > 0)
    {


        <div class="row">
            <div class="col-12 col-md-6 border border-light rounded p-2 mt-2">
                <h3>Estados</h3>


            </div>
            <div class="col-12 col-md-6 border border-light rounded p-2 mt-2">
                <h3>Edicion Estados</h3>


            </div>
        </div>
        <div class="row">
            <div class="col-12 col-md-6 border border-light rounded p-2 mt-2">
                <h3>Grupos </h3>
                <partial name="_GroupListPartial" model="Model" />


            </div>
            <div class="col-12 col-md-6 border border-light rounded p-2 mt-2">
                <h3>Edicion / Creacion Grupos</h3>
                <!-- Botón para crear un nuevo grupo -->
                <button type="button" class="btn btn-primary mb-3" onclick="loadGroupForm('@flowId')">
                    <i class="fas fa-plus"></i> Crear Grupo
                </button>
                <div id="groupFormContainer">
                    <!-- Aquí se cargará dinámicamente el formulario de creación/edición de grupos -->
                </div>


            </div>
        </div>

    }



</div>












@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        console.log('flujo');
    </script>
    <script src="~/js/datatable/datatable.js"></script>
    <script src="~/js/flow/flowForm.js"></script>
    <script>
        $(document).ready(function () {
            const flowId = '@flowId';
            const tableGroupId = '@tableGroupId';
            initializeGroupDataTable(flowId, tableGroupId);
        });
    </script>
}





